<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pastry Pup | Snack Snatch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700;800&display=swap');

        :root {
            --pastry-gold: #FFD966;
            --strawberry-pink: #FF99AC;
            --pup-brown: #5E3023;
            --creamy-white: #FFFBF2;
            --mint-green: #B2E2D2;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--creamy-white);
            color: var(--pup-brown);
            margin: 0;
            overflow: hidden;
            touch-action: none;
        }

        .btn-primary {
            background-color: var(--pastry-gold);
            color: var(--pup-brown);
            font-weight: 800;
            padding: 1.25rem 2.5rem;
            border-radius: 9999px;
            box-shadow: 0 8px 0px #e0bd4d;
            transition: all 0.1s;
            letter-spacing: 0.05em;
        }

        .btn-primary:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0px #e0bd4d;
        }

        #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: none;
            background: var(--creamy-white);
            z-index: 50;
        }

        .logo-float {
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-1deg); }
            50% { transform: translateY(-15px) rotate(1deg); }
        }

        .score-pop {
            animation: pop 0.2s ease-out;
            color: var(--strawberry-pink);
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .pup-logo-img {
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
            object-fit: contain;
        }
    </style>
</head>
<body>

    <!-- REUSABLE LOGO COMPONENT -->
    <template id="full-logo-template">
        <div class="flex flex-col items-center">
            <!-- 
                If the image is in the SAME repo and folder as index.html, use: src="logo.png"
                If using the GitHub URL, replace the src below with your GitHub Raw URL.
            -->
            <img src="logo.png" 
                 alt="Pastry Pup Logo" 
                 class="w-64 h-64 md:w-80 md:h-80 pup-logo-img"
                 onerror="this.style.display='none'">
            
            <h1 class="text-6xl font-[900] -mt-10 tracking-tighter" style="color: var(--pup-brown); -webkit-text-stroke: 1.5px white; filter: drop-shadow(2px 4px 0px var(--pastry-gold));">
                PASTRY PUP
            </h1>
        </div>
    </template>

    <!-- HOME SCREEN -->
    <div id="home-screen" class="min-h-screen flex flex-col items-center justify-center p-6 text-center">
        <div id="logo-dest-home" class="logo-float mb-12"></div>
        <div class="space-y-6 w-full max-w-xs">
            <button onclick="startGame()" class="btn-primary w-full text-2xl">PLAY GAME</button>
            <p class="text-sm font-bold opacity-40 uppercase tracking-widest italic">Slide Pastry Pup to catch treats!</p>
        </div>
    </div>

    <!-- GAME OVERLAY -->
    <div id="game-container">
        <div id="flash-overlay" class="pointer-events-none absolute inset-0 z-0"></div>
        <div class="absolute top-6 left-6 right-6 flex justify-between items-center pointer-events-none z-10">
            <div class="text-2xl font-black bg-white/90 px-5 py-2 rounded-full shadow-sm border-2 border-[--pastry-gold]">
                SCORE: <span id="current-score">0</span><span class="text-xs opacity-30">/100</span>
            </div>
            <div id="hearts-display" class="flex gap-1 text-3xl">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
        </div>

        <canvas id="gameCanvas"></canvas>

        <div id="modal" class="hidden fixed inset-0 bg-[#5E3023]/70 backdrop-blur-md flex items-center justify-center p-6 z-20">
            <div class="bg-white rounded-[40px] p-8 w-full max-w-sm text-center shadow-2xl relative overflow-hidden">
                <div id="logo-dest-modal" class="scale-75 -my-12"></div>
                <h2 id="modal-title" class="text-4xl font-black mb-2">GOOD JOB!</h2>
                <p id="modal-msg" class="text-lg mb-6 font-medium opacity-60">You're a pastry pro!</p>
                <div class="bg-amber-50 rounded-3xl p-6 mb-8 border-2 border-amber-100">
                    <span class="block text-xs uppercase font-black tracking-widest opacity-40 mb-1">Treats Caught</span>
                    <span id="final-score" class="text-6xl font-[900] text-amber-500">0</span>
                </div>
                <div class="flex flex-col gap-3">
                    <button onclick="resetGame()" class="btn-primary w-full text-xl py-4">PLAY AGAIN</button>
                    <button onclick="goToHome()" class="text-sm font-bold opacity-40 uppercase tracking-widest py-2">Main Menu</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Inject Logo
        const logoContent = document.getElementById('full-logo-template').content;
        document.getElementById('logo-dest-home').appendChild(logoContent.cloneNode(true));
        document.getElementById('logo-dest-modal').appendChild(logoContent.cloneNode(true));

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('current-score');
        const heartsDisplay = document.getElementById('hearts-display');
        const modal = document.getElementById('modal');
        const flashOverlay = document.getElementById('flash-overlay');

        let active = false;
        let score = 0;
        let lives = 3;
        let items = [];
        let lastSpawn = 0;
        let spawnTime = 1200;
        let speed = 3.5;
        let lastMilestone = 0;

        // Player (Pastry Pup) State
        let playerX = window.innerWidth / 2;
        const playerWidth = 120;
        const playerHeight = 120;

        const TREATS = ['üßÅ', 'üç™', 'üç©', 'üç∞', 'ü•ê', 'ü•Ø'];
        const BUGS = ['ü™≤', 'ü™≥', 'ü¶ü', 'üï∑Ô∏è'];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            playerX = canvas.width / 2;
        }
        window.addEventListener('resize', resize);
        resize();

        class Item {
            constructor() {
                this.r = 25;
                this.x = this.r + Math.random() * (canvas.width - this.r * 2);
                this.y = -50;
                this.v = speed + Math.random() * (speed * 0.4);
                this.rot = Math.random() * Math.PI * 2;
                this.rv = (Math.random() - 0.5) * 0.1;
                const bugChance = 0.2 + (score / 350);
                this.isBug = Math.random() < Math.min(bugChance, 0.45);
                this.emoji = this.isBug ? BUGS[Math.floor(Math.random() * BUGS.length)] : TREATS[Math.floor(Math.random() * TREATS.length)];
            }
            update() { this.y += this.v; this.rot += this.rv; }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rot);
                ctx.font = "40px Arial";
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                ctx.fillText(this.emoji, 0, 0);
                ctx.restore();
            }
        }

        function drawPlayer() {
            const yPos = canvas.height - 110;
            ctx.save();
            ctx.translate(playerX, yPos);
            
            // Tan Floppy Ears
            ctx.fillStyle = "#d4a373";
            ctx.strokeStyle = "#5E3023";
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.ellipse(-50, -10, 25, 45, Math.PI / 8, 0, Math.PI * 2);
            ctx.fill(); ctx.stroke();
            ctx.beginPath();
            ctx.ellipse(50, -10, 25, 45, -Math.PI / 8, 0, Math.PI * 2);
            ctx.fill(); ctx.stroke();
            
            // Head Base
            ctx.fillStyle = "#f3d5b5";
            ctx.beginPath();
            ctx.roundRect(-45, -40, 90, 80, 40);
            ctx.fill(); ctx.stroke();
            
            // White Blaze
            ctx.fillStyle = "white";
            ctx.beginPath();
            ctx.ellipse(0, -25, 12, 30, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Eyes
            ctx.fillStyle = "#333";
            ctx.beginPath();
            ctx.arc(-22, -12, 6, 0, Math.PI * 2); ctx.fill(); 
            ctx.beginPath();
            ctx.arc(22, -12, 6, 0, Math.PI * 2); ctx.fill(); 
            
            // Nose
            ctx.fillStyle = "#5E3023";
            ctx.beginPath();
            ctx.arc(0, 10, 6, 0, Math.PI * 2); ctx.fill();
            
            // Mouth
            ctx.strokeStyle = "#5E3023";
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(0, 15, 8, 0.1 * Math.PI, 0.9 * Math.PI);
            ctx.stroke();

            // Paws
            ctx.fillStyle = "white";
            ctx.beginPath(); ctx.arc(-35, 45, 12, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
            ctx.beginPath(); ctx.arc(35, 45, 12, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
            
            ctx.restore();
        }

        function gameLoop(t) {
            if (!active) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (t - lastSpawn > spawnTime) {
                items.push(new Item());
                lastSpawn = t;
            }
            drawPlayer();
            const playerY = canvas.height - 110;
            for (let i = items.length - 1; i >= 0; i--) {
                const it = items[i];
                it.update();
                it.draw();
                const dx = Math.abs(it.x - playerX);
                const dy = Math.abs(it.y - playerY);
                if (dx < 60 && dy < 50) {
                    if (it.isBug) {
                        lives--;
                        updateUI();
                        flashOverlay.classList.add('bg-red-500/20');
                        setTimeout(() => flashOverlay.classList.remove('bg-red-500/20'), 150);
                        if (lives <= 0) endGame(false);
                    } else {
                        score++;
                        updateUI();
                        if (score >= 100) endGame(true);
                        else if (score % 10 === 0 && score !== lastMilestone) {
                            lastMilestone = score;
                            speed += 1.2;
                            spawnTime = Math.max(300, spawnTime - 150);
                            flashOverlay.classList.add('bg-amber-500/10');
                            setTimeout(() => flashOverlay.classList.remove('bg-amber-500/10'), 200);
                        }
                    }
                    items.splice(i, 1);
                    continue;
                }
                if (it.y > canvas.height + 50) {
                    items.splice(i, 1);
                }
            }
            requestAnimationFrame(gameLoop);
        }

        function movePlayer(e) {
            if (!active) return;
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            playerX = Math.max(60, Math.min(canvas.width - 60, x));
        }

        function updateUI() {
            scoreDisplay.innerText = score;
            heartsDisplay.innerText = "‚ù§Ô∏è".repeat(lives) + "üñ§".repeat(3 - lives);
            scoreDisplay.parentElement.classList.add('score-pop');
            setTimeout(() => scoreDisplay.parentElement.classList.remove('score-pop'), 200);
        }

        function startGame() {
            document.getElementById('home-screen').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            resetGame();
        }

        function resetGame() {
            score = 0; lives = 3; items = [];
            spawnTime = 1200; speed = 3.5; lastMilestone = 0;
            active = true;
            modal.classList.add('hidden');
            updateUI();
            requestAnimationFrame(gameLoop);
        }

        function endGame(win) {
            active = false;
            document.getElementById('modal-title').innerText = win ? "PRO BARKER!" : "GAME OVER";
            document.getElementById('modal-title').style.color = win ? "var(--strawberry-pink)" : "var(--pup-brown)";
            document.getElementById('modal-msg').innerText = win ? "You caught all 100 treats!" : "Bugs got the treats!";
            document.getElementById('final-score').innerText = score;
            modal.classList.remove('hidden');
            if (win) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#FFD966', '#FF99AC', '#B2E2D2'] });
            }
        }

        function goToHome() {
            active = false;
            document.getElementById('home-screen').style.display = 'flex';
            document.getElementById('game-container').style.display = 'none';
            modal.classList.add('hidden');
        }

        window.addEventListener('mousemove', movePlayer);
        window.addEventListener('touchmove', (e) => { e.preventDefault(); movePlayer(e); }, {passive: false});
    </script>
</body>
</html>
